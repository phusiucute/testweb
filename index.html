<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Kho Tài Liệu - Free Share</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand:500,700&display=swap">
  <style>
    body {
      background: #f7f9fb;
      font-family: 'Quicksand', sans-serif;
      margin: 0;
      padding: 0;
      color: #222;
    }
    header {
      background: #fff;
      border-bottom: 1px solid #e3e3e3;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 76px;
      position: relative;
      padding: 0 32px;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
      min-width: 0;
    }
    .main-logo {
      height: 50px;
      width: 50px;
      border-radius: 15px;
      background: #f8f8ff;
      border: 2px solid #1976d2;
      object-fit: cover;
      box-shadow: 0 2px 12px rgba(25, 118, 210, 0.10);
    }
    .header-title {
      font-size: 1.52rem;
      font-weight: 800;
      letter-spacing: 1px;
      color: #1976d2;
      text-shadow: 0 1px 7px rgba(25,118,210,0.07);
      margin-left: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 200px;
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .header-social-btn {
      width: 38px; height: 38px;
      border-radius: 50%;
      background: #f8f8ff;
      border: 2px solid #e3e3e3;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.14s, box-shadow 0.14s;
      box-shadow: 0 2px 10px rgba(25,118,210,0.04);
      cursor: pointer;
    }
    .header-social-btn img {
      width: 22px;height: 22px;display: block;
    }
    .header-social-btn:hover {background: #e3f2fd;}
    @media (max-width:700px) {
      .header-title {font-size:0.7rem;max-width:800px;}
      .main-logo {width:35px;height:35px;}
      .header-left {padding-left:9px;}
      .header-right {padding-right:9px;gap:7px;}
      header {height:56px;}
      .header-social-btn {width:28px;height:28px;}
      .header-social-btn img {width:16px;height:16px;}
      .header-title {margin-left:7px;}
    }
    @media (max-width:430px) {
      .header-title {max-width:72px;}
    }

    /* 2 Cột: promo rộng + sidebar trái */
    .main-layout {
      display: flex;
      gap: 32px;
      justify-content: center;
      align-items: flex-start;
      margin: 32px auto 0 auto;
      max-width: 1350px;
      width: 100%;
    }
    .sidebar-left {
      width: 320px;
      min-width: 240px;
      display: flex;
      flex-direction: column;
      gap: 22px;
      align-items: flex-end;
    }

    .main-content {
      flex: 1 1 0%;
      min-width: 350px;
      max-width: 900px;
      margin-right: 0;
    }

    /* Promo box cực rộng */
    .promo {
      background: linear-gradient(90deg, #fffde7 60%, #e4eeff 100%);
      border: 2.5px solid #ffb300;
      border-radius: 18px;
      padding: 38px 40px 26px 40px;
      font-size: 1.22rem;
      color: #222;
      font-weight: 500;
      box-shadow: 0 2px 12px rgba(255,193,7,0.11);
      margin-bottom: 28px;
      margin-top: 0;
      line-height: 1.7;
      position: relative;
      width: 100%;
      max-width: 900px;
      min-width: 300px;
    }
    .promo strong { color: #d84315; font-size: 1.13em;}
    .promo u {color: #1565c0;}
    .promo .ibzalo {
      color:#e53935;font-size:1.13em;background:rgba(255,235,238,0.94);
      padding:2px 8px;border-radius:8px;
      box-shadow:0 1px 5px #ffeaea;
      font-weight: 900;
      letter-spacing: 1px;
      margin: 0 2px;
      cursor: pointer;
      text-decoration: underline dotted #e53935 1.5px;
      transition: box-shadow 0.14s,background 0.14s;
    }
    .promo .ibzalo:hover {background:#fff1f2;box-shadow:0 3px 11px #ffcdd2;}
    .promo .promo-combo {display:block;margin:10px 0 3px 0;font-weight:700;color:#1976d2;}
    .promo-highlight {color:#1976d2;font-weight:700;}
    .promo-list {margin:0 0 0 16px;}
    .promo-list li {margin-bottom:3px;}

    /* Đếm ngược kỳ thi trái */
    .exam-countdown-card {
      background: #e8f5e9;
      border-radius: 17px;
      box-shadow: 0 2px 14px rgba(56,142,60,0.12);
      padding: 20px 25px 18px 25px;
      color: #1976d2;
      font-size: 1.08rem;
      margin-bottom: 10px;
      text-align: center;
      border: 2px solid #b2dfdb;
      width: 100%;
      max-width: 312px;
      min-width: 220px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .exam-countdown-title {
      font-size:1.11rem;
      font-weight:700;
      color:#1976d2;
      margin-bottom: 9px;
      letter-spacing: 0.2px;
      text-align: center;
      width: 100%;
    }
    .exam-countdown-box {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 11px;
      background: #fff;
      border-radius: 11px;
      padding: 8px 9px;
      font-family: 'Quicksand',sans-serif;
      font-weight: 700;
      font-size: 18px;
      box-shadow: 0 2px 9px rgba(255,193,7,0.10);
      margin-bottom: 0;
    }
    .exam-countdown-number {
      background: #fff;
      color: #43a047;
      border-radius: 10px;
      padding: 7px 8px 4px 8px;
      min-width: 44px;
      margin-right: 2px;
      text-align: center;
      font-size: 1.08rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: inherit;
      box-shadow: 0 1px 6px #ffecb3;
    }
    .exam-countdown-unit {
      color: #388e3c;
      font-size: 0.92rem;
      font-weight: 600;
      margin-top: 2px;
      display: block;
      letter-spacing: .3px;
    }
    /* Message box dưới countdown */
    .message-card {
      background: #f4fff6;
      color: #388e3c;
      border: 2px solid #c8e6c9;
      border-radius: 15px;
      box-shadow: 0 2px 14px rgba(56,142,60,0.08);
      padding: 18px 15px 12px 15px;
      font-style: italic;
      font-size: 1.07rem;
      line-height: 1.6;
      margin-bottom: 8px;
      min-height: 90px;
      text-align: center;
      position: relative;
      width: 100%;
      max-width: 312px;
      min-width: 220px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .message-card-title {
      font-weight: bold;
      color: #1976d2;
      margin-bottom: 7px;
      font-size: 1.06rem;
      display: block;
    }
    .message-card-date {
      color: #388e3c;
      font-size: 0.92rem;
      margin-bottom: 5px;
      display: block;
    }
    /* Zalo FAB */
    .zalo-fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 100;
      width: 56px;
      height: 56px;
      background: #008EE6;
      border-radius: 50%;
      box-shadow: 0 5px 24px rgba(0, 142, 230, 0.18);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 4px solid #fff;
      font-size: 16px;
      font-weight: bold;
      color: #fff;
      letter-spacing: 0.5px;
      text-align: center;
      line-height: 1.1;
      padding: 0;
      transition: box-shadow 0.17s;
    }
    .zalo-fab span {
      display: block;
      width: 100%;
      text-align: center;
      line-height: 1.15;
      font-size: 16px;
      font-weight: bold;
      color: #fff;
      padding: 0 2px;
      white-space: pre-line;
      word-break: break-word;
    }
    @media (max-width: 1100px) {
      .main-layout { flex-direction: column; align-items: stretch; }
      .sidebar-left { flex-direction: row; width: 99vw; justify-content: flex-start; }
      .main-content { max-width: 100vw;}
      .promo {max-width: none;}
    }
    @media (max-width: 900px) {
      .promo {padding:14px 2vw;}
      .main-layout {gap: 10px;}
    }
    @media (max-width: 700px) {
      .sidebar-left {flex-direction: column; width: 99vw; align-items: stretch;}
      .main-content {padding:0 2vw;}
      .promo {padding: 7vw 2vw;}
    }
    footer {
      margin-top: 50px;
      background: linear-gradient(90deg, #e3f2fd 0%, #fffde7 100%);
      padding: 33px 0 24px 0;
      color: #1959a0;
      border-top: 2.5px solid #e3f2fd;
      font-size: 1.11rem;
      letter-spacing: .3px;
      text-align: center;
      box-shadow: 0 -2px 16px rgba(25,118,210,0.06);
      font-weight: 600;
      border-radius: 31px 31px 0 0 / 19px 19px 0 0;
      position: relative;
      overflow: hidden;
    }
    .footer-inner {
      display: inline-block;
      background: #fff;
      padding: 17px 30px 14px 30px;
      border-radius: 14px;
      box-shadow: 0 3px 24px rgba(25,118,210,0.08);
      font-size: 1.07rem;
    }
    .footer-strong {
      color: #e53935;
      font-size: 1.13em;
      font-weight: 800;
      letter-spacing: .7px;
      margin: 0 4px;
    }
    .footer-link {
      color: #1976d2;
      font-weight: 700;
      text-decoration: underline;
      margin: 0 6px;
      transition: color 0.14s;
    }
    .footer-link:hover { color: #d84315;}
  </style>
</head>
<body>
  <!-- POPUP ADS -->
  <div class="ads-modal-bg" id="adsModalBg">
    <div class="ads-modal">
      <button class="ads-modal-close" id="adsModalClose" aria-label="Đóng quảng cáo">&times;</button>
      <img src="ads.png" alt="Quảng cáo nổi bật">
    </div>
  </div>
  <!-- HEADER -->
  <header>
    <div class="header-left">
      <img src="logo.png" alt="Logo" class="main-logo" onerror="this.style.display='none'">
      <div class="header-title">v1.0</div>
    </div>
    <div class="header-right">
      <a href="https://zalo.me/0788559492" target="_blank" class="header-social-btn" title="Zalo">
        <img src="zalo.png" alt="Zalo">
      </a>
      <a href="https://www.tiktok.com/@khoahocgiasiure" target="_blank" class="header-social-btn" title="TikTok">
        <img src="tiktok.png" alt="TikTok">
      </a>
      <a href="https://www.threads.net/@khoahocgiasiure" target="_blank" class="header-social-btn" title="Threads">
        <img src="logothreads.png" alt="Threads">
      </a>
    </div>
  </header>
  <div class="main-layout">
    <div class="sidebar-left">
      <div class="exam-countdown-card">
        <div class="exam-countdown-title">Đếm ngược kỳ thi<br>THPT QG 2025</div>
        <div class="exam-countdown-box">
          <div class="exam-countdown-number"><span id="countdown-day">00</span><span class="exam-countdown-unit">Ngày</span></div>
          <div class="exam-countdown-number"><span id="countdown-hour">00</span><span class="exam-countdown-unit">Giờ</span></div>
          <div class="exam-countdown-number"><span id="countdown-minute">00</span><span class="exam-countdown-unit">Phút</span></div>
          <div class="exam-countdown-number"><span id="countdown-second">00</span><span class="exam-countdown-unit">Giây</span></div>
        </div>
      </div>
      <div class="message-card">
        <span class="message-card-title" id="message-date"></span>
        <span id="message-content"></span>
      </div>
    </div>
    <div class="main-content">
      <div class="promo">
        <strong>🎓 KHÓA HỌC XPS – LỚP 10, 11, 12 – CẤP TỐC, GIÁ RẺ</strong><br>
        <span style="color:#1976d2;font-weight:600;">Ưu đãi tháng này – Học trọn gói từ A–Z, chọn thầy cô theo gu của bạn!</span><br>
        <span class="promo-combo"><u>Combo Lớp 12 – dành cho 2K7:</u></span>
        <ul class="promo-list">
          <li>✅ Giá: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá </span> nhé</li>
          <li>📌 TẶNG kèm: Khóa học lớp 10 + 11 bản 2025</li>
        </ul>
        <span class="promo-combo"><u>Combo Lớp 12 – dành cho 2K8:</u></span>
        <ul class="promo-list">
          <li>✅ Giá: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá</span> nhé</li>
          <li>📌 TẶNG kèm: Khóa học lớp 10 + 11 bản 2025</li>
        </ul>
        <span class="promo-combo"><u>Combo Lớp 11/10 – dành cho 2K9/2K10:</u></span>
        <ul class="promo-list">
          <li>✅ Giá: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá</span> nhé</li>
          <li>📌 Có cả tổ hợp: Toán, Văn, Anh, KHTN, KHXH</li>
          <li>📌 TẶNG: Khóa học lớp 10 bản 2025</li>
        </ul>
        <span class="promo-highlight">🆓 ĐƯỢC HỌC THỬ 24 GIỜ MIỄN PHÍ trước khi đăng ký</span><br>
        ♻️ Cập nhật bài giảng mới mỗi tuần, có file luyện đề, hệ thống ôn tập cuối kỳ<br>
        <b style="color:#1976d2;">🎯 Đặc biệt:</b><br>
        <ul class="promo-list">
          <li>Khóa TOEIC cô Mai Phương: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá</span> nhé</li>
          <li>Khóa IELTS nền tảng – nâng band: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá</span> nhé</li>
          <li>Khóa sinh viên ôn lại gốc lớp 12: <span class="ibzalo" onclick="window.open('https://zalo.me/0788559492','_blank')">click vào đây để được báo giá</span> nhé</li>
        </ul>
        <span style="color:#d84315;font-weight:600;">⏳ Ưu đãi giới hạn trong tháng – nhanh tay đăng ký để không bỏ lỡ!</span>
      </div>
      <div class="tabs" id="classTabs"></div>
      <div class="subjects" id="subjectTabs"></div>
      <div class="doc-list" id="documentList"></div>
    </div>
  </div>
  <!-- Zalo Nổi -->
  <div class="zalo-fab" id="zaloFab" title="Nhắn Zalo để được tư vấn ngay!">
    <span>Liên hệ</span>
  </div>
  <footer>
    <div class="footer-inner">
      <span class="footer-strong">Liên hệ:</span>
      <a href="https://zalo.me/0788559492" class="footer-link" target="_blank" rel="noopener">Zalo 0788559492</a>
      &bull;
      <a href="https://www.tiktok.com/@khoahocgiasiure" class="footer-link" target="_blank" rel="noopener">TikTok @khoahocgiasiure</a>
      &bull;
      <a href="https://www.threads.net/@khoahocgiasiure" class="footer-link" target="_blank" rel="noopener">Threads @khoahocgiasiure</a>
      <br>
      <span style="color:#888;font-weight:400;display:block;margin-top:7px;">
        &copy; 2025 <b style="color:#1976d2;font-weight:800">by @phusiucute</b> &mdash; Share tài liệu khoá học 10, 11, 12 giá rẻ, nhanh, uy tín.
      </span>
    </div>
  </footer>
  <script>
    // Popup quảng cáo
    window.addEventListener("DOMContentLoaded", function() {
      const bg = document.getElementById('adsModalBg');
      const closeBtn = document.getElementById('adsModalClose');
      function closeAds() {
        bg.style.display = "none";
      }
      closeBtn.onclick = closeAds;
      bg.onclick = function(e) {
        if (e.target === bg) closeAds();
      }
      setTimeout(closeAds, 12000);
    });

    // Đếm ngược kỳ thi
    const examDate = new Date("2025-06-26T07:45:00+07:00");
    function updateExamCountdown() {
      const now = new Date();
      const diff = examDate - now;
      let days = 0, hours = 0, minutes = 0, seconds = 0;
      if (diff > 0) {
        days = Math.floor(diff / (1000 * 60 * 60 * 24));
        hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        minutes = Math.floor((diff / (1000 * 60)) % 60);
        seconds = Math.floor((diff / 1000) % 60);
      }
      document.getElementById("countdown-day").textContent = days.toString().padStart(2, "0");
      document.getElementById("countdown-hour").textContent = hours.toString().padStart(2, "0");
      document.getElementById("countdown-minute").textContent = minutes.toString().padStart(2, "0");
      document.getElementById("countdown-second").textContent = seconds.toString().padStart(2, "0");
    }
    setInterval(updateExamCountdown, 1000);
    updateExamCountdown();

    // Zalo FAB chat
    const zaloFab = document.getElementById('zaloFab');
    zaloFab.onclick = function() {
      window.open('https://zalo.me/0788559492', '_blank');
    };

    // === GOOGLE SHEET CODE GIỮ NGUYÊN ===
    const SHEET_ID = "1hXvKb09Bu5xzqFAlgRjZ1S3Z0uQ8wjfDVQQn4uAuYH0";
    const SHEET_API = `https://opensheet.elk.sh/${SHEET_ID}/Sheet1`;
    const SHEET_API_MSG = `https://opensheet.elk.sh/${SHEET_ID}/Sheet2`;
    const subjectList = ["toán","lý","hóa","sinh","sử","địa","văn","tiếng anh"];
    let allDocs = [];
    let classList = [];
    let currentClass = "";
    let currentSubject = subjectList[0];

    function renderClassTabs() {
      const classTabs = document.getElementById("classTabs");
      classTabs.innerHTML = "";
      classList.forEach(cls => {
        const tab = document.createElement("div");
        tab.className = "tab" + (cls===currentClass ? " active" : "");
        tab.innerText = "Lớp " + cls;
        tab.onclick = () => {
          currentClass = cls;
          let found = subjectList.find(subj => allDocs.some(doc => doc.class === cls && doc.subject === subj));
          currentSubject = found || subjectList[0];
          renderClassTabs(); renderSubjectTabs(); renderDocs();
        };
        classTabs.appendChild(tab);
      });
    }
    function renderSubjectTabs() {
      const subjectTabs = document.getElementById("subjectTabs");
      subjectTabs.innerHTML = "";
      subjectList.forEach(sub => {
        if (allDocs.some(doc => doc.class === currentClass && doc.subject === sub)) {
          const tab = document.createElement("div");
          tab.className = "subject" + (sub===currentSubject ? " active" : "");
          tab.innerText = sub.charAt(0).toUpperCase() + sub.slice(1);
          tab.onclick = () => { currentSubject = sub; renderSubjectTabs(); renderDocs(); };
          subjectTabs.appendChild(tab);
        }
      });
    }
    function renderDocs() {
      const docList = document.getElementById("documentList");
      docList.innerHTML = "";
      const docs = allDocs.filter(doc => doc.class === currentClass && doc.subject === currentSubject);
      if (!docs || docs.length === 0) {
        docList.innerHTML = "<div style='grid-column:1/-1;text-align:center;color:#999;font-size:1.1rem'>Chưa có tài liệu cho mục này.</div>";
        return;
      }
      docs.forEach((doc, idx) => {
        const div = document.createElement("div");
        div.className = "doc-box";
        const key = "clicked_" + (doc.title||"") + "_" + (doc.class||"") + "_" + (doc.subject||"");
        div.onclick = () => {
          const isFirst = !localStorage.getItem(key);
          if(isFirst && doc.shopee_link){
            localStorage.setItem(key, "true");
            window.open(doc.shopee_link, "_blank");
          } else if(doc.drive_link) {
            window.open(doc.drive_link, "_blank");
          }
        };
        div.innerHTML = `<span class="doc-icon">📄</span>
          <span class="doc-title">${doc.title||"(Không có tên tài liệu)"}</span>
          <div class="doc-date">Cập nhật: ${doc.updatedAt||""}</div>
        `;
        docList.appendChild(div);
      });
    }

    fetch(SHEET_API)
      .then(res => res.json())
      .then(rows => {
        allDocs = rows.map(doc => ({
          ...doc,
          class: (doc.class||"").trim(),
          subject: (doc.subject||"").trim().toLowerCase(),
          title: (doc.title||"").trim(),
          drive_link: (doc.drive_link||"").trim(),
          shopee_link: (doc.shopee_link||"").trim(),
          updatedAt: (doc.updatedAt||"").trim()
        })).filter(doc => doc.class && doc.subject && doc.title);
        classList = [...new Set(allDocs.map(doc=>doc.class))].sort((a,b) => b-a);
        currentClass = classList[0] || "";
        let found = subjectList.find(subj => allDocs.some(doc => doc.class === currentClass && doc.subject === subj));
        currentSubject = found || subjectList[0];
        renderClassTabs();
        renderSubjectTabs();
        renderDocs();
      })
      .catch(e => {
        document.getElementById("documentList").innerHTML = "<div style='color:red'>Không tải được dữ liệu từ Google Sheet. Hãy kiểm tra lại ID Sheet và quyền chia sẻ!</div>";
      });

    // ---- THÔNG ĐIỆP RANDOM MỖI NGÀY (sheet2) ----
    function updateMessageCard() {
      fetch(SHEET_API_MSG)
        .then(res => res.json())
        .then(list => {
          // Lấy random hoặc theo ngày
          if (!list || !list.length) {
            document.getElementById('message-date').textContent = "Thông điệp hôm nay";
            document.getElementById('message-content').textContent = "Chúc bạn một ngày tốt lành!";
            return;
          }
          const d = new Date();
          // Chọn random 1 dòng theo ngày/tháng/năm
          const idx = d.getDate() % list.length;
          const row = list[idx];
          document.getElementById('message-date').textContent = row.date ? `Thông điệp ${row.date}` : 'Thông điệp hôm nay';
          document.getElementById('message-content').textContent = row.message || Object.values(row)[0] || "Chúc bạn một ngày tốt lành!";
        })
        .catch(()=>{
          document.getElementById('message-date').textContent = "Thông điệp hôm nay";
          document.getElementById('message-content').textContent = "Chúc bạn một ngày tốt lành!";
        });
    }
    updateMessageCard();
  </script>
</body>
</html>
